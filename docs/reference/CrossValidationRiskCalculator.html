<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>CrossValidationRiskCalculator — CrossValidationRiskCalculator • OnlineSuperLearner</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">OnlineSuperLearner</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/OnlineSuperLearner.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>CrossValidationRiskCalculator</h1>
    </div>

    
    <p>Class that contains various methods for calculating the crossvalidated risk
of an estimator.</p>
    

    <pre class="usage"><span class='no'>CrossValidationRiskCalculator</span></pre>
        
    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>An object of class <code>R6ClassGenerator</code> of length 24.</p>
    
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
    <dl class='dl-horizontal'>
  <dt><code>initialize() </code></dt><dd><p>Creates a new cross validated risk calculator.</p></dd>
    <dt><code>calculate_evaluation(predicted.outcome, observed.outcome, relevantVariables, add_evaluation_measure_name=TRUE)</code></dt><dd><p>Calculates an evaluation using the provided predicted and observed
    outcomes. It uses a list of <code>RelevantVariable</code> objects to loop
    through all data provided to it. If the <code>predicted.outcome</code> list is
    provided with both a normalized and denormalized entry, it will use the
    normalized entry as the default. One can choose to add the evaluation
    metric that was used to the names of the output. This is done by setting
    <code>add_evaluation_measure_name</code> to true.
    The input data should look looks as followos:
      list
        normalized 
          AlgorithmName1
           data.table with a W, A, Y entry.
          AlgorithmName2
           data.table with a W, A, Y entry.
        denormalized
          AlgorithmName1
           data.table with a W, A, Y entry.
          AlgorithmName2
           data.table with a W, A, Y entry.
    The output data then looks as follows:
      list
        AlgorithmName1
         data.table with a W, A, Y entry.
        AlgorithmName2
         data.table with a W, A, Y entry.
    @param predicted.outcome the outcome predicted by the various algorithms
     in the super learner. This is a list which either has two entries
     (normalized and denormalized), and in which both those entries have a
     list of ML outputs, or it is a list of the outputs of each of the
     algorithms (e.g., the normalized output directly).
    @param observed.outcome the actual data that was observed in the study.
    @param relevantVariables the relevantvariables that are included in the
     prediction
    @param add_evaluation_measure_name (default TRUE) should we add the name
     of the evaluation metric to the output?
    @return a list with the evalutation of each of the algorithms.</p></dd>
    <dt><code>evaluate_single_outcome(observed.outcome, predicted.outcome, ra ndomVariables</code></dt><dd><p>Perform the evaluation of a single estimator. In this case the data of
    just one estimator can be provided, such as:
      AlgorithmName1
       data.table with a W, A, Y entry.
    the function will then use the default evaluation metric to determine
    the performance of the estimator.
    @param predicted.outcome the outcome predicted by a single algorithms in
     the super learner.
    @param observed.outcome the actual data that was observed in the study.
    @param relevantVariables the relevantvariables that are included in the
     prediction.
    @return a list with the evalutation of the algorithm.</p></dd>
    <dt><code>calculate_risk(predicted.outcome, observed.outcome, relevantVariables</code></dt><dd><p>Calculate the CV risk for each of the relevant variables provided based on
    the predicted and observed outcomes. This function also expects a list
    of predictions in a similar way as <code>calculate_evaluation</code> does.
    @param predicted.outcome the outcome predicted by the various algorithms
     in the super learner. This is a list which either has two entries
     (normalized and denormalized), and in which both those entries have a
     list of ML outputs, or it is a list of the outputs of each of the
     algorithms (e.g., the normalized output directly).
    @param observed.outcome the actual data that was observed in the study
     (emperically, or from a simulation).
    @param relevantVariables the relevantvariables that are included in the
     prediction
    @param add_evaluation_measure_name (default TRUE) should we add the name
     of the evaluation metric to the output?
    @return a list of lists, in which each element is the risk for one
     estimator. In each list per estimator, each element corresponds to one
     of the relevant variables.</p></dd>
    <dt><code>update_risk(predicted.outcome, observed.outcome, relevantVariables, current_count, current_risk) </code></dt><dd><p>Function used by the OSL to update a previous risk. This function uses
    the equation by Benkeser et al. (2017) to update a previous risk. What
    it does is multiply a previous risk (<code>current_risk</code>) by the
    <code>current_count</code> and add the new risk to this multiplied risk. Then
    it divides this risk by <code>current_count + 1</code> to come to the current
    risk estimate. This way we don't have to recalculate the whole risk when
    only one update is required.
    @param predicted.outcome the outcome predicted by the various algorithms
     in the super learner. This is a list which either has two entries
     (normalized and denormalized), and in which both those entries have a
     list of ML outputs, or it is a list of the outputs of each of the
     algorithms (e.g., the normalized output directly).
    @param observed.outcome the actual data that was observed in the study
     (emperically, or from a simulation).
    @param relevantVariables the relevantvariables for which the distributions
     have been calculated
    @param current_count the current number of evaluations performed for
     calculating the <code>current_risk</code>.
    @param current_risk the previously calculated risk of each of the
     estimators (calculated over <code>current_count</code> number of
     evaluations).
    @return a list of lists with the updated risk for each estimator, and
     for each estimator an estimate of the risk for each relevant variable.</p></dd>
    <dt><code>update_single_risk(old_risk, new_risks, current_count, relevantVariables) </code></dt><dd><p>Instaed of updating the risk for each of estimators, one can also update
    a single risk. In this case the risks are updated using the
    <code>old_risk</code> and <code>new_risks</code> variable. Essentially, this
    function performs the internals of the <code>update_risk</code> function,
    however, here it expects risks to be calculated beforehand instead of
    mere predictions and observed outcomes. This function uses
    the equation by Benkeser et al. (2017) to update a previous risk. What
    it does is multiply a previous risk (<code>current_risk</code>) by the
    <code>current_count</code> and add the new risk to this multiplied risk. Then
    it divides this risk by <code>current_count + 1</code> to come to the current
    risk estimate. This way we don't have to recalculate the whole risk when
    only one update is required.
    @param old_risk the old risks, calculated in a previous iteration.
    @param new_risks the new risks, calculated using the current machine learning estimators.
    @param current_count the number of iterations used to calculate the old risk.
    @param relevantVariables the relevant variables for which the predictions have been created.
    @return the updated risk as a data.table.</p></dd>
</dl>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#format">Format</a></li>

      <li><a href="#methods">Methods</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Frank Blaauw, Antoine Chambaz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
